function receiveMessage(e){console.log("Recieved Event:"+e),"https://buy.coinbase.com"===e.origin&&console.log("Coinbase Response:"+e.data)}function fillCoinbaseBuyWidget(e,n){null==$("#coinbase_widget")&&updateCoinbaseModal(e,n)}function testDomain(){"alexandria.io"!=window.location.hostname&&"localhost"!=location.hostname&&(console.log("Not on supported domains, remove Coinbase button."),$("#coinbase_widget_play").remove(),$("#coinbase_widget_download").remove(),$("#coinbase_button_iframe").remove())}function createCoinbaseModal(e,n,o){if("play"==o||"download"==o){if("play"==o&&buyWidgetSettings.play_generated||"download"==o&&buyWidgetSettings.dl_generated)return console.log("Modal already exists, reroute"),void updateCoinbaseModal(e,n);n<1&&(n=1);var a=function a(){var t=$("#coinbase_widget_"+o);console.log(t);var i=this;this.init=function(){t.domain="https://buy.coinbase.com",t.link=$("#coinbase_widget_"+o),t.button=i.generateIframe(i.buttonIframe()),t.link.parent().append(t.button),t.modal=i.generateIframe(i.modalIframe()),document.body.appendChild(t.modal),t.link.onclick=function(e){e.preventDefault(),$("#coinbase_modal_iframe").style.display="block"},window.addEventListener("message",i.handleMessage,!1)},this.generateIframe=function(e){var n=document.createElement("div");return n.innerHTML=e,n.firstChild},this.generateParams=function(o){return"?address="+encodeURIComponent(e)+("&amount="+encodeURIComponent(n))+("&code="+encodeURIComponent(buyWidgetSettings.code))+("&currency="+encodeURIComponent(buyWidgetSettings.currency))+("&crypto_currency="+encodeURIComponent(buyWidgetSettings.crypto_currency))+("&state="+encodeURIComponent(buyWidgetSettings.state))},this.modalIframeStyle=function(){return"\n      transition: all 0.3s ease-out;\n      background-color: transparent;\n      border: 0px none transparent;\n      display: none;\n      position: fixed;\n      visibility: visible;\n      margin: 0px;\n      padding: 0px;\n      left: 0px;\n      top: 0px;\n      width: 100%;\n      height: 100%;\n      z-index: 9999;\n    "},this.modalIframe=function(){$("#coinbase_modal_iframe").remove();var e=i.generateParams("asdf");return"<iframe class='coinbase_modal_iframe' src='"+t.domain+"/"+e+"'\n                    id='coinbase_modal_iframe'\n                    name='coinbase_modal_iframe'\n                    style='"+i.modalIframeStyle()+"'\n                    scrolling='no'\n                    allowtransparency='true' frameborder='0'>\n      </iframe>"},this.buttonIframeStyle=function(){return"\n      width: 273px;\n      height: 53px;\n      border: none;\n      overflow: hidden;\n      display: none;\n      border-radius: 5px;\n    "},this.buttonParams=function(e){return"?crypto_currency="+encodeURIComponent(buyWidgetSettings.crypto_currency)},this.buttonIframe=function(){console.log(t);var e=i.buttonParams("asdf");return"<iframe src='"+t.domain+"/button"+e+"'\n                    id='coinbase_button_iframe'\n                    class='coinbase_button_iframe'\n                    name='coinbase_button_iframe'\n                    style='"+i.buttonIframeStyle()+"'\n                    scrolling='no'\n                    allowtransparency='true'\n                    frameborder='0'>\n      </iframe>"},this.handleMessage=function(e){switch(e.data.event){case"modal_closed":$("#coinbase_modal_iframe").css("display","none"),$("#coinbase_modal_iframe").src=$("#coinbase_modal_iframe").src;break;case"button_loaded":$("#coinbase_widget_"+o).css("display","none"),$("#coinbase_button_iframe").css("display","block"),"play"==o?buyWidgetSettings.play_generated=!0:"download"==o&&(buyWidgetSettings.dl_generated=!0);break;case"button_clicked":$("#coinbase_modal_iframe").css("display","block")}}},t=new a;t.init()}}function updateCoinbaseModal(e,n){$("#coinbase_widget_download").css("display","none"),$("#coinbase_widget_play").css("display","none"),$(".coinbase_button_iframe").css("display","block"),n<1&&(n=1),$("#coinbase_modal_iframe").remove();var o=document.createElement("div");o.innerHTML="<iframe class='coinbase_modal_iframe' src='https://buy.coinbase.com?address="+encodeURIComponent(e)+("&amount="+encodeURIComponent(n))+("&code="+encodeURIComponent(buyWidgetSettings.code))+("&currency="+encodeURIComponent(buyWidgetSettings.currency))+("&crypto_currency="+encodeURIComponent(buyWidgetSettings.crypto_currency))+("&state="+encodeURIComponent(buyWidgetSettings.state))+"'\n                    id='coinbase_modal_iframe'\n                    name='coinbase_modal_iframe'\n                    style='\n      transition: all 0.3s ease-out;\n      background-color: transparent;\n      border: 0px none transparent;\n      display: none;\n      position: fixed;\n      visibility: visible;\n      margin: 0px;\n      padding: 0px;\n      left: 0px;\n      top: 0px;\n      width: 100%;\n      height: 100%;\n      z-index: 9999;\n    '\n                    scrolling='no'\n                    allowtransparency='true' frameborder='0'>\n      </iframe>",document.body.appendChild(o.firstChild)}function hideCoinbaseButton(){$("#coinbase_widget_download").css("display","none"),$("#coinbase_widget_play").css("display","none"),$("#coinbase_modal_iframe").css("display","none"),$("#coinbase_button_iframe").css("display","none")}var buyWidgetSettings={code:"169c6c3a-d404-55f4-82f4-24cd25f5c5f6",currency:"USD",crypto_currency:"BTC",state:123,play_generated:!1,dl_generated:!1};createCoinbaseModal("",0);